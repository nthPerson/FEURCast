2025-11-09 23:19:08,542 - INFO - ================================================================================
2025-11-09 23:19:08,542 - INFO - FUREcast GBR Model Training Pipeline
2025-11-09 23:19:08,542 - INFO - ================================================================================
2025-11-09 23:19:08,542 - INFO - Log file: /home/robert/FEURCast/streamlit/production/pred_model/logs/training_log_20251109_231908.txt
2025-11-09 23:19:08,542 - INFO - Random seed: 42
2025-11-09 23:19:08,542 - INFO - Loading data from /home/robert/FEURCast/data/rich_features_SPLG_history_full.csv
2025-11-09 23:19:08,610 - INFO - Loaded 5025 records with 116 columns
2025-11-09 23:19:08,618 - INFO - Date range: 2005-11-15 00:00:00 to 2025-11-05 19:00:00
2025-11-09 23:19:08,618 - INFO - Feature columns: 111
2025-11-09 23:19:08,618 - INFO - Target: target_return_t1 (next-day percentage return)
2025-11-09 23:19:08,622 - INFO - 
============================================================
2025-11-09 23:19:08,622 - INFO - PERFORMING DATA QUALITY CHECKS AND CLEANING
2025-11-09 23:19:08,622 - INFO - ============================================================
2025-11-09 23:19:08,622 - INFO - Initial dataset size: 5025 rows, 111 features
2025-11-09 23:19:08,623 - INFO - ✓ No infinite values found
2025-11-09 23:19:08,624 - INFO - 
NaN Statistics (before cleaning):
2025-11-09 23:19:08,624 - INFO -   Total feature NaNs: 6044
2025-11-09 23:19:08,624 - INFO -   Features with NaNs: 62 of 111
2025-11-09 23:19:08,624 - INFO -   Target NaNs: 0
2025-11-09 23:19:08,624 - INFO - 
Features with >5% NaN values:
2025-11-09 23:19:08,624 - INFO -   beta: 4996 (99.4%)
2025-11-09 23:19:08,625 - INFO - 
Dropping rows with NaN values in features or target...
2025-11-09 23:19:08,625 - INFO - (This preserves early historical data that has all features populated)
2025-11-09 23:19:08,626 - INFO - Dropped 4996 rows with NaN values (99.4%)
2025-11-09 23:19:08,626 - INFO - Remaining records: 29
2025-11-09 23:19:08,627 - INFO - 
✓ All data quality checks passed
2025-11-09 23:19:08,630 - INFO - 
Final cleaned dataset:
2025-11-09 23:19:08,631 - INFO -   Shape: 29 samples × 111 features
2025-11-09 23:19:08,631 - INFO -   Date range: 2025-09-25 20:00:00 to 2025-11-05 19:00:00
2025-11-09 23:19:08,631 - INFO - 
Target (next-day return) statistics:
2025-11-09 23:19:08,631 - INFO -   Mean:       0.000512
2025-11-09 23:19:08,631 - INFO -   Std:        0.008689
2025-11-09 23:19:08,631 - INFO -   Min:       -0.026849
2025-11-09 23:19:08,631 - INFO -   1st %ile:  -0.022605
2025-11-09 23:19:08,631 - INFO -   Median:     0.001869
2025-11-09 23:19:08,631 - INFO -   99th %ile:  0.018807
2025-11-09 23:19:08,631 - INFO -   Max:        0.020251
2025-11-09 23:19:08,631 - INFO - ============================================================

2025-11-09 23:19:08,632 - INFO - Creating time-based train/val/test splits (70%/15%/15%)
2025-11-09 23:19:08,632 - INFO - Train: 2025-09-25 20:00:00 to 2025-10-22 20:00:00 (20 samples)
2025-11-09 23:19:08,633 - INFO - Val:   2025-10-26 20:00:00 to 2025-10-29 20:00:00 (4 samples)
2025-11-09 23:19:08,633 - INFO - Test:  2025-10-30 20:00:00 to 2025-11-05 19:00:00 (5 samples)
2025-11-09 23:19:08,633 - INFO - Scaling features with StandardScaler
2025-11-09 23:19:08,636 - INFO - Feature scaling complete
2025-11-09 23:19:08,637 - INFO - Training with recommended hyperparameters (quick mode)...
2025-11-09 23:19:08,654 - INFO - Quick training complete
2025-11-09 23:19:08,654 - INFO - 
================================================================================
2025-11-09 23:19:08,654 - INFO - MODEL EVALUATION
2025-11-09 23:19:08,654 - INFO - ================================================================================
2025-11-09 23:19:08,656 - INFO - 
Training Set Performance:
2025-11-09 23:19:08,656 - INFO -   MSE:  0.00005061
2025-11-09 23:19:08,656 - INFO -   RMSE: 0.007114
2025-11-09 23:19:08,656 - INFO -   MAE:  0.004300
2025-11-09 23:19:08,656 - INFO -   R²:   0.390370
2025-11-09 23:19:08,656 - INFO -   MAPE: 85051630.84%
2025-11-09 23:19:08,656 - INFO -   Directional Accuracy: 75.00%
2025-11-09 23:19:08,657 - INFO - 
Validation Set Performance:
2025-11-09 23:19:08,657 - INFO -   MSE:  0.00004222
2025-11-09 23:19:08,657 - INFO -   RMSE: 0.006498
2025-11-09 23:19:08,657 - INFO -   MAE:  0.004479
2025-11-09 23:19:08,657 - INFO -   R²:   -0.361986
2025-11-09 23:19:08,657 - INFO -   MAPE: 105.93%
2025-11-09 23:19:08,657 - INFO -   Directional Accuracy: 25.00%
2025-11-09 23:19:08,659 - INFO - 
Test Set Performance:
2025-11-09 23:19:08,659 - INFO -   MSE:  0.00005768
2025-11-09 23:19:08,659 - INFO -   RMSE: 0.007594
2025-11-09 23:19:08,659 - INFO -   MAE:  0.006122
2025-11-09 23:19:08,659 - INFO -   R²:   -0.340926
2025-11-09 23:19:08,659 - INFO -   MAPE: 129.63%
2025-11-09 23:19:08,659 - INFO -   Directional Accuracy: 60.00%
2025-11-09 23:19:08,660 - INFO - Saving model artifacts...
2025-11-09 23:19:08,663 - INFO - Saved model to /home/robert/FEURCast/streamlit/production/pred_model/models/gbr_model.pkl
2025-11-09 23:19:08,664 - INFO - Saved scaler to /home/robert/FEURCast/streamlit/production/pred_model/models/scaler.pkl
2025-11-09 23:19:08,664 - INFO - Saved feature names to /home/robert/FEURCast/streamlit/production/pred_model/models/feature_names.pkl
2025-11-09 23:19:08,664 - INFO - Saved metrics to /home/robert/FEURCast/streamlit/production/pred_model/models/metrics.json
2025-11-09 23:19:08,666 - INFO - Saved feature importance to /home/robert/FEURCast/streamlit/production/pred_model/models/feature_importance.csv
2025-11-09 23:19:08,666 - INFO - Saved model metadata to /home/robert/FEURCast/streamlit/production/pred_model/models/model_metadata.json
2025-11-09 23:19:08,666 - INFO - All artifacts saved successfully
2025-11-09 23:19:08,667 - INFO - 
================================================================================
2025-11-09 23:19:08,667 - INFO - TRAINING COMPLETE
2025-11-09 23:19:08,667 - INFO - ================================================================================
2025-11-09 23:19:08,667 - INFO - Final Test R² Score: -0.340926
2025-11-09 23:19:08,667 - INFO - Final Test RMSE: 0.007594
2025-11-09 23:19:08,667 - INFO - Final Test Directional Accuracy: 60.00%
2025-11-09 23:19:08,667 - INFO - Top 5 Features:
2025-11-09 23:19:08,667 - INFO -   lag_5_return: 0.1103
2025-11-09 23:19:08,668 - INFO -   ma_10_slope: 0.1066
2025-11-09 23:19:08,668 - INFO -   volume: 0.0862
2025-11-09 23:19:08,668 - INFO -   macd_hist: 0.0645
2025-11-09 23:19:08,668 - INFO -   obv: 0.0543
2025-11-09 23:19:08,668 - INFO - 
All artifacts saved to:
2025-11-09 23:19:08,668 - INFO -   Models: /home/robert/FEURCast/streamlit/production/pred_model/models
2025-11-09 23:19:08,668 - INFO -   Logs: /home/robert/FEURCast/streamlit/production/pred_model/logs/training_log_20251109_231908.txt
