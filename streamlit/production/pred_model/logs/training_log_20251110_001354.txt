2025-11-10 00:13:54,290 - INFO - ================================================================================
2025-11-10 00:13:54,290 - INFO - FUREcast GBR Model Training Pipeline
2025-11-10 00:13:54,291 - INFO - ================================================================================
2025-11-10 00:13:54,291 - INFO - Log file: /home/robert/FEURCast/streamlit/production/pred_model/logs/training_log_20251110_001354.txt
2025-11-10 00:13:54,291 - INFO - Random seed: 42
2025-11-10 00:13:54,291 - INFO - Loading data from /home/robert/FEURCast/data/rich_features_SPLG_history_full.csv
2025-11-10 00:13:54,357 - INFO - Loaded 5026 records with 116 columns
2025-11-10 00:13:54,361 - INFO - Date range: 2005-11-15 00:00:00 to 2025-11-06 19:00:00
2025-11-10 00:13:54,361 - INFO - Feature columns: 111
2025-11-10 00:13:54,361 - INFO - Target: target_return_t1 (next-day percentage return)
2025-11-10 00:13:54,364 - INFO - 
============================================================
2025-11-10 00:13:54,364 - INFO - PERFORMING DATA QUALITY CHECKS AND CLEANING
2025-11-10 00:13:54,364 - INFO - ============================================================
2025-11-10 00:13:54,364 - INFO - Initial dataset size: 5026 rows, 111 features
2025-11-10 00:13:54,365 - INFO - ✓ No infinite values found
2025-11-10 00:13:54,366 - INFO - 
NaN Statistics (before cleaning):
2025-11-10 00:13:54,366 - INFO -   Total feature NaNs: 6044
2025-11-10 00:13:54,366 - INFO -   Features with NaNs: 62 of 111
2025-11-10 00:13:54,366 - INFO -   Target NaNs: 1
2025-11-10 00:13:54,367 - INFO - 
Features with >5% NaN values:
2025-11-10 00:13:54,367 - INFO -   beta: 4996 (99.4%)
2025-11-10 00:13:54,367 - INFO - 
Applying intelligent NaN handling strategy...
2025-11-10 00:13:54,367 - INFO - Dropping 1 columns with >95.0% NaN:
2025-11-10 00:13:54,367 - INFO -   beta: 99.4% NaN
2025-11-10 00:13:54,368 - INFO - Remaining features: 110
2025-11-10 00:13:54,368 - INFO - 
Forward-filling NaN in 81 rolling/technical indicator features...
2025-11-10 00:13:54,390 - INFO -   NaN values filled: 1001 → 0
2025-11-10 00:13:54,390 - INFO - 
Dropping rows with NaN in basic features or target...
2025-11-10 00:13:54,392 - INFO - Remaining NaN in 6 features:
2025-11-10 00:13:54,392 - INFO -   return_1d: 1 (0.0%)
2025-11-10 00:13:54,392 - INFO -   log_return: 1 (0.0%)
2025-11-10 00:13:54,392 - INFO -   return_5d: 5 (0.1%)
2025-11-10 00:13:54,392 - INFO -   return_10d: 10 (0.2%)
2025-11-10 00:13:54,392 - INFO -   return_20d: 20 (0.4%)
2025-11-10 00:13:54,393 - INFO -   roc_10: 10 (0.2%)
2025-11-10 00:13:54,401 - INFO - Dropped 21 rows (0.4%)
2025-11-10 00:13:54,401 - INFO - ✓ Final training set: 5005 samples
2025-11-10 00:13:54,403 - INFO - 
✓ All data quality checks passed
2025-11-10 00:13:54,405 - INFO - 
Final cleaned dataset:
2025-11-10 00:13:54,405 - INFO -   Shape: 5005 samples × 110 features
2025-11-10 00:13:54,405 - INFO -   Date range: 2005-12-14 00:00:00 to 2025-11-05 19:00:00
2025-11-10 00:13:54,405 - INFO - 
Target (next-day return) statistics:
2025-11-10 00:13:54,406 - INFO -   Mean:       0.000405
2025-11-10 00:13:54,406 - INFO -   Std:        0.011668
2025-11-10 00:13:54,406 - INFO -   Min:       -0.116761
2025-11-10 00:13:54,406 - INFO -   1st %ile:  -0.034586
2025-11-10 00:13:54,406 - INFO -   Median:     0.000225
2025-11-10 00:13:54,406 - INFO -   99th %ile:  0.031242
2025-11-10 00:13:54,406 - INFO -   Max:        0.095256
2025-11-10 00:13:54,406 - INFO - ============================================================

2025-11-10 00:13:54,406 - INFO - Creating time-based train/val/test splits (70%/15%/15%)
2025-11-10 00:13:54,406 - INFO - Train: 2005-12-14 00:00:00 to 2019-11-13 00:00:00 (3503 samples)
2025-11-10 00:13:54,407 - INFO - Val:   2019-11-14 00:00:00 to 2022-11-04 00:00:00 (750 samples)
2025-11-10 00:13:54,407 - INFO - Test:  2022-11-07 00:00:00 to 2025-11-05 19:00:00 (752 samples)
2025-11-10 00:13:54,407 - INFO - Scaling features with StandardScaler
2025-11-10 00:13:54,415 - INFO - Feature scaling complete
2025-11-10 00:13:54,415 - INFO - Performing GridSearch hyperparameter tuning (this may take a while)...
2025-11-10 00:16:43,970 - INFO - 
============================================================
2025-11-10 00:16:43,970 - INFO - HYPERPARAMETER TUNING RESULTS
2025-11-10 00:16:43,970 - INFO - ============================================================
2025-11-10 00:16:43,970 - INFO - Best parameters found:
2025-11-10 00:16:43,970 - INFO -   learning_rate: 0.01
2025-11-10 00:16:43,970 - INFO -   max_depth: 3
2025-11-10 00:16:43,970 - INFO -   max_features: log2
2025-11-10 00:16:43,970 - INFO -   min_samples_leaf: 4
2025-11-10 00:16:43,970 - INFO -   min_samples_split: 5
2025-11-10 00:16:43,970 - INFO -   n_estimators: 100
2025-11-10 00:16:43,970 - INFO -   subsample: 0.8
2025-11-10 00:16:43,971 - INFO - Best CV MSE: 0.000132
2025-11-10 00:16:43,971 - INFO - 
These parameters will be used for future --quick training
2025-11-10 00:16:43,971 - INFO - ============================================================

2025-11-10 00:16:43,971 - INFO - 
================================================================================
2025-11-10 00:16:43,971 - INFO - MODEL EVALUATION
2025-11-10 00:16:43,971 - INFO - ================================================================================
2025-11-10 00:16:43,975 - INFO - 
Training Set Performance:
2025-11-10 00:16:43,975 - INFO -   MSE:  0.00011275
2025-11-10 00:16:43,975 - INFO -   RMSE: 0.010618
2025-11-10 00:16:43,975 - INFO -   MAE:  0.006848
2025-11-10 00:16:43,975 - INFO -   R²:   0.066090
2025-11-10 00:16:43,975 - INFO -   MAPE: 29227539.44%
2025-11-10 00:16:43,975 - INFO -   Directional Accuracy: 51.27%
2025-11-10 00:16:43,977 - INFO - 
Validation Set Performance:
2025-11-10 00:16:43,977 - INFO -   MSE:  0.00024837
2025-11-10 00:16:43,977 - INFO -   RMSE: 0.015760
2025-11-10 00:16:43,977 - INFO -   MAE:  0.010262
2025-11-10 00:16:43,977 - INFO -   R²:   -0.006940
2025-11-10 00:16:43,977 - INFO -   MAPE: 2774904.23%
2025-11-10 00:16:43,977 - INFO -   Directional Accuracy: 54.53%
2025-11-10 00:16:43,979 - INFO - 
Test Set Performance:
2025-11-10 00:16:43,979 - INFO -   MSE:  0.00009631
2025-11-10 00:16:43,979 - INFO -   RMSE: 0.009814
2025-11-10 00:16:43,979 - INFO -   MAE:  0.006755
2025-11-10 00:16:43,979 - INFO -   R²:   0.010434
2025-11-10 00:16:43,979 - INFO -   MAPE: 5714493.96%
2025-11-10 00:16:43,979 - INFO -   Directional Accuracy: 55.05%
2025-11-10 00:16:43,979 - INFO - Saving model artifacts...
2025-11-10 00:16:43,983 - INFO - Saved model to /home/robert/FEURCast/streamlit/production/pred_model/models/gbr_model.pkl
2025-11-10 00:16:43,984 - INFO - Saved scaler to /home/robert/FEURCast/streamlit/production/pred_model/models/scaler.pkl
2025-11-10 00:16:43,984 - INFO - Saved feature names to /home/robert/FEURCast/streamlit/production/pred_model/models/feature_names.pkl
2025-11-10 00:16:43,988 - INFO - Saved metrics to /home/robert/FEURCast/streamlit/production/pred_model/models/metrics.json
2025-11-10 00:16:43,991 - INFO - Saved feature importance to /home/robert/FEURCast/streamlit/production/pred_model/models/feature_importance.csv
2025-11-10 00:16:43,994 - INFO - Saved model metadata to /home/robert/FEURCast/streamlit/production/pred_model/models/model_metadata.json
2025-11-10 00:16:43,995 - INFO - All artifacts saved successfully
2025-11-10 00:16:43,995 - INFO - 
================================================================================
2025-11-10 00:16:43,995 - INFO - TRAINING COMPLETE
2025-11-10 00:16:43,995 - INFO - ================================================================================
2025-11-10 00:16:43,995 - INFO - Final Test R² Score: 0.010434
2025-11-10 00:16:43,995 - INFO - Final Test RMSE: 0.009814
2025-11-10 00:16:43,995 - INFO - Final Test Directional Accuracy: 55.05%
2025-11-10 00:16:43,995 - INFO - Top 5 Features:
2025-11-10 00:16:43,996 - INFO -   rolling_mean_return_5d: 0.0342
2025-11-10 00:16:43,996 - INFO -   rsi_14: 0.0325
2025-11-10 00:16:43,997 - INFO -   price_ma_20_ratio: 0.0308
2025-11-10 00:16:43,997 - INFO -   price_ma_200_ratio: 0.0283
2025-11-10 00:16:43,997 - INFO -   return_10d: 0.0280
2025-11-10 00:16:43,997 - INFO - 
All artifacts saved to:
2025-11-10 00:16:43,997 - INFO -   Models: /home/robert/FEURCast/streamlit/production/pred_model/models
2025-11-10 00:16:43,997 - INFO -   Logs: /home/robert/FEURCast/streamlit/production/pred_model/logs/training_log_20251110_001354.txt
