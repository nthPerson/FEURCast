2025-10-19 23:26:54,423 - INFO - ================================================================================
2025-10-19 23:26:54,423 - INFO - FUREcast GBR Model Training Pipeline
2025-10-19 23:26:54,423 - INFO - ================================================================================
2025-10-19 23:26:54,423 - INFO - Log file: /home/robert/FEURCast/streamlit/production/pred_model/logs/training_log_20251019_232654.txt
2025-10-19 23:26:54,423 - INFO - Random seed: 42
2025-10-19 23:26:54,423 - INFO - Loading data from /home/robert/FEURCast/data/rich_features_SPLG_history_full.csv
2025-10-19 23:26:54,477 - INFO - Loaded 4796 records with 115 columns
2025-10-19 23:26:54,481 - INFO - Date range: 2006-08-31 00:00:00 to 2025-09-24 00:00:00
2025-10-19 23:26:54,481 - INFO - Feature columns: 110
2025-10-19 23:26:54,481 - INFO - Target: target_return_t1 (next-day percentage return)
2025-10-19 23:26:54,485 - INFO - Performing data quality checks...
2025-10-19 23:26:54,487 - INFO - Checking for extreme outliers...
2025-10-19 23:26:54,530 - WARNING - Found extreme outliers in 2 features
2025-10-19 23:26:54,530 - WARNING -   high_low_pct: 0 low, 1 high
2025-10-19 23:26:54,530 - WARNING -   vol_change: 0 low, 5 high
2025-10-19 23:26:54,530 - INFO - 
Final cleaned dataset: 4796 samples, 110 features
2025-10-19 23:26:54,530 - INFO - Target statistics:
2025-10-19 23:26:54,530 - INFO -   Mean:   0.000414
2025-10-19 23:26:54,530 - INFO -   Std:    0.011832
2025-10-19 23:26:54,530 - INFO -   Min:    -0.116761
2025-10-19 23:26:54,530 - INFO -   Max:    0.095256
2025-10-19 23:26:54,531 - INFO -   Median: 0.000319
2025-10-19 23:26:54,533 - INFO - ✓ Data quality checks passed
2025-10-19 23:26:54,533 - INFO - Creating time-based train/val/test splits (70%/15%/15%)
2025-10-19 23:26:54,533 - INFO - Train: 2006-08-31 00:00:00 to 2020-01-02 00:00:00 (3357 samples)
2025-10-19 23:26:54,534 - INFO - Val:   2020-01-03 00:00:00 to 2022-11-08 00:00:00 (719 samples)
2025-10-19 23:26:54,534 - INFO - Test:  2022-11-09 00:00:00 to 2025-09-24 00:00:00 (720 samples)
2025-10-19 23:26:54,534 - INFO - Scaling features with StandardScaler
2025-10-19 23:26:54,539 - INFO - Feature scaling complete
2025-10-19 23:26:54,540 - INFO - Performing GridSearch hyperparameter tuning (this may take a while)...
2025-10-19 23:29:39,197 - INFO - Best parameters: {'learning_rate': 0.01, 'max_depth': 3, 'max_features': 'log2', 'min_samples_leaf': 2, 'min_samples_split': 10, 'n_estimators': 100, 'subsample': 0.9}
2025-10-19 23:29:39,197 - INFO - Best CV MSE: 0.000115
2025-10-19 23:29:39,197 - INFO - 
================================================================================
2025-10-19 23:29:39,197 - INFO - MODEL EVALUATION
2025-10-19 23:29:39,197 - INFO - ================================================================================
2025-10-19 23:29:39,201 - INFO - 
Training Set Performance:
2025-10-19 23:29:39,201 - INFO -   MSE:  0.00011501
2025-10-19 23:29:39,201 - INFO -   RMSE: 0.010724
2025-10-19 23:29:39,201 - INFO -   MAE:  0.006986
2025-10-19 23:29:39,201 - INFO -   R²:   0.071397
2025-10-19 23:29:39,201 - INFO -   MAPE: 25520503.92%
2025-10-19 23:29:39,201 - INFO -   Directional Accuracy: 51.77%
2025-10-19 23:29:39,202 - INFO - 
Validation Set Performance:
2025-10-19 23:29:39,202 - INFO -   MSE:  0.00025999
2025-10-19 23:29:39,202 - INFO -   RMSE: 0.016124
2025-10-19 23:29:39,202 - INFO -   MAE:  0.010610
2025-10-19 23:29:39,202 - INFO -   R²:   -0.011685
2025-10-19 23:29:39,203 - INFO -   MAPE: 3493192.40%
2025-10-19 23:29:39,203 - INFO -   Directional Accuracy: 53.41%
2025-10-19 23:29:39,204 - INFO - 
Test Set Performance:
2025-10-19 23:29:39,204 - INFO -   MSE:  0.00009861
2025-10-19 23:29:39,204 - INFO -   RMSE: 0.009930
2025-10-19 23:29:39,204 - INFO -   MAE:  0.006782
2025-10-19 23:29:39,204 - INFO -   R²:   -0.006273
2025-10-19 23:29:39,204 - INFO -   MAPE: 5697781.45%
2025-10-19 23:29:39,204 - INFO -   Directional Accuracy: 55.97%
2025-10-19 23:29:39,204 - INFO - Saving model artifacts...
2025-10-19 23:29:39,207 - INFO - Saved model to /home/robert/FEURCast/streamlit/production/pred_model/models/gbr_model.pkl
2025-10-19 23:29:39,207 - INFO - Saved scaler to /home/robert/FEURCast/streamlit/production/pred_model/models/scaler.pkl
2025-10-19 23:29:39,208 - INFO - Saved feature names to /home/robert/FEURCast/streamlit/production/pred_model/models/feature_names.pkl
2025-10-19 23:29:39,212 - INFO - Saved metrics to /home/robert/FEURCast/streamlit/production/pred_model/models/metrics.json
2025-10-19 23:29:39,215 - INFO - Saved feature importance to /home/robert/FEURCast/streamlit/production/pred_model/models/feature_importance.csv
2025-10-19 23:29:39,218 - INFO - Saved model metadata to /home/robert/FEURCast/streamlit/production/pred_model/models/model_metadata.json
2025-10-19 23:29:39,218 - INFO - All artifacts saved successfully
2025-10-19 23:29:39,218 - INFO - 
================================================================================
2025-10-19 23:29:39,218 - INFO - TRAINING COMPLETE
2025-10-19 23:29:39,218 - INFO - ================================================================================
2025-10-19 23:29:39,218 - INFO - Final Test R² Score: -0.006273
2025-10-19 23:29:39,218 - INFO - Final Test RMSE: 0.009930
2025-10-19 23:29:39,219 - INFO - Final Test Directional Accuracy: 55.97%
2025-10-19 23:29:39,219 - INFO - Top 5 Features:
2025-10-19 23:29:39,219 - INFO -   price_ma_200_ratio: 0.0865
2025-10-19 23:29:39,220 - INFO -   price_ma_50_ratio: 0.0429
2025-10-19 23:29:39,220 - INFO -   lag_3_return: 0.0342
2025-10-19 23:29:39,220 - INFO -   high_low_pct: 0.0320
2025-10-19 23:29:39,220 - INFO -   return_10d: 0.0303
2025-10-19 23:29:39,220 - INFO - 
All artifacts saved to:
2025-10-19 23:29:39,220 - INFO -   Models: /home/robert/FEURCast/streamlit/production/pred_model/models
2025-10-19 23:29:39,220 - INFO -   Logs: /home/robert/FEURCast/streamlit/production/pred_model/logs/training_log_20251019_232654.txt
